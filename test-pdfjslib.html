<!DOCTYPE html>
<html>

<head></head>

<body>
    <input type="file" id="fileInput" accept="application/pdf" />
    <pre id="output" style="white-space: pre-wrap;"></pre>
    <!-- Load the pdf.js library as a module -->
    <script type="module">
        import * as pdfjsLib from 'https://mozilla.github.io/pdf.js/build/pdf.mjs';

        pdfjsLib.GlobalWorkerOptions.workerSrc =
            'https://mozilla.github.io/pdf.js/build/pdf.worker.mjs';

        async function extractTextFromPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            let fullText = '';
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const content = await page.getTextContent();
                const strings = content.items.map((item) => item.str);
                fullText += `\n[Side ${i}]\n` + strings.join(' ');
            }
            return fullText;
        }

        document
            .getElementById('fileInput')
            .addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                if (file.type !== 'application/pdf') {
                    alert('Vælg en PDF-fil.');
                    return;
                }
                document.getElementById('output').textContent =
                    'Indlæser og udtrækker tekst...';
                try {
                    const text = await extractTextFromPDF(file);
                    document.getElementById('output').textContent = text;
                    console.log('PDF tekst:', text);
                } catch (err) {
                    document.getElementById('output').textContent =
                        'Fejl: ' + err.message;
                    console.error(err);
                }
            });
    </script>
</body>

</html>